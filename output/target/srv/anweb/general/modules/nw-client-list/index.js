"use strict";!function(){var nw=angular.module(regdep("nw-client-list"),["devinfo"]);nw.directive("nwClientList",["$compile","funcs","nwClientListUtil",function($compile,funcs,util){function link($scope,$element,$attrs){function addDropList(){$attrs.$set("nwClientList","false"),$element.attr("nw-drop-list",""),$element.attr("nw-drop-list-options",key+".info"),$compile($element)($scope)}function updateClientsInfo(){if($scope[key].clients){var clients=util.prepareClientsList($scope[key].clients,$scope[key].version,$scope[key].direction,$scope[key].exclude,$scope[key].filterFn);$scope[key].info=util.formClientsInfo(clients,$attrs.nwClientListType,$scope[key].iface,$scope[key].band,$scope[key].wifiAPData)}}if("false"!=$attrs.nwClientList){clientListNumber++;var key="clientList_"+clientListNumber;$scope[key]={info:[],exclude:[],clients:null,version:null,direction:null,band:null},function(){return _.has($attrs,"nwDropList")&&_.has($attrs,"nwDropListOptions")}()||function(){addDropList(),util.pull($element.attr("nw-client-list-source")).then(function(result){$scope[key].clients=result.clients,$scope[key].iface=result.iface,$scope[key].wifiAPData=result.wifiAPData,updateClientsInfo()})}(),$attrs.$observe("nwClientListVersion",function(value){$scope[key].version!=value&&($scope[key].version=value,updateClientsInfo())}),$attrs.$observe("nwClientListDirection",function(value){$scope[key].direction!=value&&($scope[key].direction=value,updateClientsInfo())}),$attrs.$observe("nwClientListExclude",function(value){value&&($scope[key].exclude=$scope.$eval(value),updateClientsInfo())}),$attrs.$observe("nwClientListBand",function(value){value&&($scope[key].band=$scope.$eval(value),updateClientsInfo())})}}return funcs.is,{restrict:"A",require:"ngModel",link:link}}]);var clientListNumber=0;nw.directive("nwClientListCore",["nwClientListUtil",function(util){return{restrict:"A",link:function($scope,$element,$attrs,$model){function setValue(value){_.isUndefined($attrs.nwHostname)||(value=punycode.toUnicode(value)),$model.$setViewValue(value.slice(0,63)),$model.$render()}util.pull("all").then(function(result){var model,knownClients=result.clients,clientMac=$attrs.nwClientListCoreMac?$attrs.nwClientListCoreMac:null,clientIp=$attrs.nwClientListCoreIp?$attrs.nwClientListCoreIp:null,clientHostname=$attrs.ngModel?$attrs.ngModel:null;model=$attrs.nwClientListCoreIp?clientIp:clientMac,$scope.$watchCollection("["+model+", "+clientHostname+"]",function(newVal,oldVal){var client,oldModel=oldVal&&oldVal[0]?oldVal[0].toLowerCase():null,newModel=newVal&&newVal[0]?newVal[0].toLowerCase():null,oldHostname=oldVal&&oldVal[1]?oldVal[1]:null,newHostname=newVal&&newVal[1]?newVal[1]:null;if(model===clientMac&&(client=newVal&&newVal[0]?util.findClient(knownClients,newModel,"mac"):null),model===clientIp&&(client=newVal&&newVal[0]?util.findClient(knownClients,newModel,"ip"):null),client){if(newModel==oldModel)return;setValue(util.getHostname(client))}else newVal&&newHostname&&setValue(newHostname!=oldHostname&&""!=newHostname||newModel!=oldModel?newHostname:oldHostname)})})},require:"ngModel"}}])}();