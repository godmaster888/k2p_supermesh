"use strict";!function(){angular.module(regdep("wifi-backup"),["device"]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$injector","$rootScope",function($injector,$rootScope){function isFactoryReset(config){return"/cpe"==config.url&&config.data&&"FactoryReset"==config.data.method}function startBackup(){function fetch(profile){var security=profile.Security,radius=profile.Security.RADIUS;return{SSID:profile.SSID,WPAPSK:security.KeyPassphrase,EncrypType:security.EncryptionType,ModeEnabled:security.ModeEnabled,OpenWEP:"WEP"==security.EncryptionType,DefaultKeyID:security.WEPKeySelected,WEPasHEX:"HEX"==security.WEPKey[1].Type,WEPKey1:security.WEPKey[1].Str,WEPKey2:security.WEPKey[2].Str,WEPKey3:security.WEPKey[3].Str,WEPKey4:security.WEPKey[4].Str,PreSharedKey:security.KeyPassphrase,RadiusServerIPAddr:radius?radius.ServerIPAddr:null,RadiusServerPort:radius?radius.ServerPort:null,RadiusSecret:radius?radius.Secret:null,EncryptionType:"TKIPAES"==security.EncryptionType?"TKIP+AES":security.EncryptionType,RekeyingInterval:security.RekeyingInterval}}var funcs=$injector.get("funcs"),devinfo=$injector.get("devinfo");return devinfo.auth.once("version|Device.WiFi.").then(function(response){var data=response["Device.WiFi."],list=funcs.newConfig.instanceObjectToArray(funcs.fetchBranch(data,"Device.WiFi.Radio."));_.each(list,function(radio){var link=funcs.fetchBranch(radio,"AccessPoint.1.Profile"),profile=funcs.fetchBranch(data,link),key="2.4GHz"==radio.OperatingFrequencyBand?"mbssid":"5G_mbssid";$rootScope.dlinkMobileApp.isUserInMobileApp()&&$rootScope.dlinkMobileApp.saveValue&&$rootScope.dlinkMobileApp.hasSaveValueFunc?$rootScope.dlinkMobileApp.saveValue(key,JSON.stringify([fetch(profile)])):sessionStorage.setItem(key,JSON.stringify([fetch(profile)]))})})}return{request:function(config){return isFactoryReset(config)?startBackup().then(function(){return config}):config},requestError:function(config){return config},response:function(res){return res},responseError:function(res){return res}}}])}])}();