"use strict";var sorttt;!function(){var nw=angular.module(regdep("nw-table"),[]);nw.directive("nwTable",["$injector","$compile","$q","$timeout","nwTableService",function($injector,$compile,$q,$timeout,nwTableService){var scheduler=$injector.has("scheduler")?$injector.get("scheduler"):{isSupport:!1},postLink=function($scope,$element){$element.prepend($compile("<div nw-table-toolbar></div>")($scope))};return{restrict:"A",scope:{title:"@nwTableTitle",needEmptyTitle:"=nwTableNeedEmptyTitle",desc:"@nwTableDesc",empty:"=nwTableEmptyStatus",emptyDesc:"@nwTableEmptySubtitle",onAdd:"&nwTableOnAdd",onAddDisable:"&nwTableOnAddDisable",onAddHide:"&nwTableOnAddHide",onDelete:"&nwTableOnDelete",onDeleteHide:"&nwTableOnDeleteHide",onEdit:"&nwTableOnEdit",onEditDisable:"&nwTableOnEditDisable",onMessage:"&nwTableOnMessage",onMessageDisable:"&nwTableOnMessageDisable",onMessageHide:"&nwTableOnMessageHide",onCustomEvent:"&nwTableOnCustomEvent",onCustomEventHide:"&nwTableOnCustomEventHide",onSecondCustomEvent:"&nwTableOnSecondCustomEvent",onSecondCustomEventHide:"&nwTableOnSecondCustomEventHide",customEventName:"@nwTableCustomEventName",secondCustomEventName:"@nwTableSecondCustomEventName",onCustomEventOnSelected:"&nwTableOnCustomEventOnSelected",onCustomEventOnSelectedHide:"&nwTableOnCustomEventOnSelectedHide",matchedFunc:"&nwTableSelectedMatchedFunc",onCustomEventOnSelectedDisable:"&nwTableOnCustomEventOnSelectedDisable",onCustomEventDisable:"&nwTableOnCustomEventDisable",selectedRows:"=?nwTableSelected",selectedRowsHide:"&nwTableSelectedHide",sortedFunc:"&nwTableSortedFunc",isSorted:"@nwTableSortedFunc",toolbarDisabled:"&nwTableToolbarDisabled",needShowRow:"&nwTableNeedShowRow",onUpward:"&nwTableOnUpward",onUpwardDisable:"&nwTableOnUpwardDisable",onUpwardHide:"&nwTableOnUpwardHide",onDownward:"&nwTableOnDownward",onDownwardDisable:"&nwTableDownwardDisable",onDownwardHide:"&nwTableDownwardHide",onReplacement:"&nwTableOnReplacement",onReplacementDisable:"&nwTableOnReplacementDisable",onReplacementHide:"&nwTableOnReplacementHide",onExport:"&nwTableOnExport",onExportDisable:"&nwTableOnExportDisable",onExportHide:"&nwTableOnExportHide",onGenerate:"&nwTableOnGenerate",onGenerateDisable:"&nwTableOnGenerateDisable",onImport:"&nwTableOnImport",onImportDisable:"&nwTableOnImportDisable"},compile:function($element,$attrs){function hasAttr(name){return!_.isUndefined($attrs[name])}var buttons,$toggleMenu,$divLimit,$divTableFixedContainer,$container=angular.element('<div class="nw-table-empty-container" ng-if="'+$attrs.nwTableEmptyStatus+'"></div>'),$titleEmpty=angular.element('<div class="title" ng-bind="\''+$attrs.nwTableEmptyTitle+"' | translate\"></div>"),$buttonPanel=angular.element('<div class="nwtable_toolbar_rightfloat"></div>');if($attrs.nwTableEmptyButton)if($attrs.nwTableEmptyButtonClick.match("add"))var buttons='<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButtonClick+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('addDisable') && onAddDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnAddHide+'" title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div>';else if($attrs.nwTableEmptyButton.match("message"))var buttons='<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButtonClick+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('messageDisable') && onMessageDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnMessageHide+'" title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div>';else buttons='<button type="button" class="colored flat" ng-bind="\''+$attrs.nwTableEmptyButton+'\' | translate"ng-click="'+$attrs.nwTableEmptyButtonClick+'"></button>';$attrs.nwTableEmptyButton2&&(buttons+=$attrs.nwTableEmptyButton2.match("add")?'<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButton2Click+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('addDisable') && onAddDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnAddHide+'" title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div>':$attrs.nwTableEmptyButton2.match("message")?'<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButton2Click+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('messageDisable') && onMessageDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnMessageHide+'" title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div>':'<button type="button" class="colored flat" ng-bind="\''+$attrs.nwTableEmptyButton2+'\' | translate"ng-click="'+$attrs.nwTableEmptyButton2Click+'"></button>'),$buttonPanel.append(buttons);var $subtitleEmpty=angular.element('<div class="subtitle" ng-bind="\''+$attrs.nwTableEmptySubtitle+"' | translate\"></div>");$container.append($titleEmpty),$container.append($buttonPanel),$container.append($subtitleEmpty),$element.append($container);var $table=$element.find("table");$table.attr("ng-if","!"+$attrs.nwTableEmptyStatus);var $head=$element.find("thead"),$body=$element.find("tbody"),$row={$head:$head.find("tr"),$body:$body.find("tr")},$cell={$head:$row.$head.find("th")};return $table.addClass("nw-mini-table"),hasAttr("nwMiniTableOff")&&$table.removeClass("nw-mini-table"),$row.$head.attr("nw-table-head-row",""),$row.$body.attr("nw-table-row",""),(hasAttr("nwTableSelected")||hasAttr("nwTableOnEdit"))&&$row.$body.attr("nw-table-row-action",""),hasAttr("nwTableSelected")&&!hasAttr("nwTableSorted")&&($row.$head.attr("nw-table-row-select-all",""),$row.$body.attr("nw-table-row-select","")),hasAttr("nwTableSelected")&&hasAttr("nwTableSorted")&&$row.$body.attr("nw-table-row-select",""),hasAttr("nwTableSelectedHide")&&($row.$head.attr("nw-table-row-select-hide",$attrs.nwTableSelectedHide),$row.$body.attr("nw-table-row-select-hide",$attrs.nwTableSelectedHide)),hasAttr("nwTableOnEdit")&&$row.$body.attr("nw-table-row-click",""),hasAttr("nwTableOnEditDisable")&&($row.$body.attr("nw-table-edit-disable",$attrs.nwTableOnEditDisable),$row.$head.attr("nw-table-edit-disable",$attrs.nwTableOnEditDisable)),scheduler.isSupport&&($row.$head.attr("nw-table-schedule-column","head"),$row.$body.attr("nw-table-schedule-column","")),hasAttr("nwTableSorted")&&(hasAttr("nwTableSelected")&&$row.$head.attr("nw-table-row-sorted-and-select-all",""),hasAttr("nwTableSelected")||$row.$head.attr("nw-table-row-sorted",""),$toggleMenu=angular.element("<div></div>"),$toggleMenu.addClass("block_toggle_menu"),_.each($cell.$head,function(elem){var $thSpan,$thSpan2,$cell=angular.element(elem),itemMenu=angular.element("<div class='item_toggle_menu'></div>"),param=$cell.attr("nw-table-sort-param");$cell.attr("ng-bind")&&($thSpan=angular.element("<span></span>"),$thSpan.attr("ng-bind",$cell.attr("ng-bind")),$thSpan2=angular.element("<span class='toggle_text'></span>"),$thSpan2.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($thSpan),itemMenu.addClass("sortable"),itemMenu.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),itemMenu.attr("ng-class",'getColumnClass("'+param+'")'),itemMenu.append($thSpan2),$cell.removeAttr("ng-bind"));var $arrow=angular.element('<span class="sortable-icon-box"><svg svg-icon="arrow"></svg></span>'),$arrow2=angular.element('<span class="sortable-icon-box"><svg svg-icon="arrow"></svg></span>');$cell.append($arrow),itemMenu.append($arrow2),$toggleMenu.append(itemMenu)}),$row.$head.append($toggleMenu)),hasAttr("nwTableLimit")&&($divLimit=angular.element("<div class='nwtable_limit'></div>"),$divTableFixedContainer=angular.element("<div class='nwtable_fixed-container'></div>"),$divTableFixedContainer.attr("ng-if","!"+$attrs.nwTableEmptyStatus),$divLimit.append($table),$divTableFixedContainer.append($divLimit),_.each($cell.$head,function(elem){var $thSpan,$divFixed=angular.element("<div class='nwtable_fixed-cell'></div>"),$cell=angular.element(elem);$cell.attr("ng-bind")?($thSpan=angular.element("<span></span>"),$thSpan.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($thSpan),$divFixed.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($divFixed),$cell.removeAttr("ng-bind")):($divFixed.append($cell.clone().contents()),$cell.append($divFixed))}),$row.$head.addClass("nwtable_fixed-header"),$element.append($divTableFixedContainer)),postLink},controller:function($scope,$element,$attrs){function getParams(obj,param){var keys=[];for(var inst in obj)for(var key in obj[inst])key==param&&keys.push(obj[inst][key]);return keys}function findSelectedIndex(item,key){var inx,items=self.selected;for(inx=0;inx<items.length;inx++){if(items[inx].key==key)return inx;if(_.isEqual(items[inx].item,item))return inx}return-1}function getIndexesLink(){function getValueParam(str){return str=str.replace(/[\[\]\'\"]/g,""),str.split(",")}var attrArr,result=[],attrStr=$attrs.scheduleIndexesLink;return attrStr&&(attrStr=attrStr.replace(/\s/g,""),attrArr=attrStr.split("],["),result=attrArr.length>1?_.map(attrArr,function(str){return getValueParam(str)}):getValueParam(attrStr)),result}var self=this,nwTableScheduler={};scheduler.isSupport&&(nwTableScheduler=$injector.get("nwTableScheduler"),scheduler.getSchedulerData()),this.items,this.selected=$scope.selectedRows=[],this.showToggle=!1,$scope.sortParamInit=$attrs.nwTableSortParamInit?$attrs.nwTableSortParamInit:"",$scope.sortDirectionInit=$attrs.nwTableSortDirectionInit?$attrs.nwTableSortDirectionInit:"desc",$scope.sortParam||($scope.sortParam=angular.copy($scope.sortParamInit)),$scope.sortDirection||($scope.sortDirection=angular.copy($scope.sortDirectionInit)),_.has($attrs,"nwTableSorted")&&!_.has($attrs,"nwTableNotSortInit")&&$timeout(function(){self.action.sorted($scope.sortParam,$scope.sortDirection)}),this.isReadyBody=$q.defer(),this.isReadyBody.promise.then(function(ngRepeat){$scope.$parent.$watch(ngRepeat.items,function(newValue,oldValue){(_.isUndefined(self.items)||newValue!==oldValue)&&(self.items=newValue),self.selected.length&&_.has($attrs,"nwTableSelectedMatchedFunc")?self.selected=_.filter(self.selected,function(item){return self.action.matched(item,newValue)}):self.selected.length&&newValue!==oldValue&&self.selected.splice(0)},!0)}),this.safeCall=function(name){var _len,args,_key;for(_len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_len>_key;_key++)args[_key-1]=arguments[_key];return _.isFunction($scope[name])?$scope[name].apply($scope,args):void 0},this.isAction=function(name){function capitalizeFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function checkOnScheduler(id){return scheduler.isSupport?scheduler.checkPageSchedulerSupported(id):!1}var result,attr;return"schedule"===name?result=$attrs.schedule?checkOnScheduler($attrs.schedule):!1:(attr=$attrs["nwTableOn"+capitalizeFirstLetter(name)],result=!_.isUndefined(attr)),result},this.action={add:function($event){$event.preventDefault(),$scope.onAddDisable()||$scope.onAdd()},message:function($event){$event.preventDefault(),$scope.onMessageDisable()||$scope.onMessage()},"delete":function($event){if($event.preventDefault(),self.isSelected()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnDelete);args.first&&(params[args.first]=_.pluck(self.selected,"item")),args.second&&(params[args.second]=_.pluck(self.selected,"key")),$scope.onDelete(params)}},setSchedule:function($event,itemTable,inxRow){if(itemTable||($event.preventDefault(),self.isSelected())){var isNotReload="scheduleNotReload"in $attrs;nwTableScheduler.startScheduleDialog({branches:function(itemTable,inxRow){function getLinks(rule,indexesLink,itemTable,inxRow,nameDynamicLink){function pushLinks(inx){function pushLink(indexes){var link=scheduler.getFullLink(rule,indexes,dynamicLink);result.push(link)}var indexes=_.clone(indexesLink);inx&&indexes.push(inx),_.isArray(indexes[0])?(indexes=scheduler.parseIndexesLink(indexes),_.each(indexes,function(inxs){pushLink(inxs)})):pushLink(indexes)}var inx,dynamicLink,result=[],indexesLink=nwTableScheduler.initIndexesLink(itemTable,indexesLink);return itemTable&&nameDynamicLink&&(dynamicLink=itemTable[nameDynamicLink]),indexesLink&&_.isArray(indexesLink[0])?pushLinks():(inx=nwTableScheduler.getIdBranch(itemTable)||inxRow,_.isArray(inx)?_.each(inx,function(i){return pushLinks(i)}):pushLinks(inx)),result}var link,result=[],rule=$attrs.schedule,nameDynamicLink=$attrs.scheduleDynamicLink,indexesLink=getIndexesLink($attrs);return itemTable?(link=getLinks(rule,indexesLink,itemTable,inxRow,nameDynamicLink),result=result.concat(link)):_.each(self.selected,function(elem){var link=getLinks(rule,indexesLink,elem.item,elem.key,nameDynamicLink);result=result.concat(link)}),result}(itemTable,inxRow),isNeedReload:!isNotReload},$scope).then(function(res){res&&res.isReset&&($scope.nwTable.selected=[])})}},edit:function($event,itemTable,inxRow){if($event.preventDefault(),!$scope.onEditDisable()){var useSchedule=!1;self.isAction("schedule")&&(useSchedule=self.checkSchedule(itemTable,inxRow));var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnEdit);args.first&&(params[args.first]=itemTable,self.isAction("schedule")&&(params[args.first].useSchedule=useSchedule)),args.second&&(params[args.second]=inxRow),$scope.onEdit(params)}},customEvent:function($event){$event.preventDefault(),$scope.onCustomEventDisable()||$scope.onCustomEvent()},secondCustomEvent:function($event){$event.preventDefault(),$scope.onSecondCustomEvent()},customEventOnSelected:function($event){if($event.preventDefault(),self.isSelected()&&!$scope.onCustomEventOnSelectedDisable()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnCustomEventOnSelected);args.first&&(params[args.first]=_.pluck(self.selected,"item")),args.second&&(params[args.second]=_.pluck(self.selected,"key")),$scope.onCustomEventOnSelected(params)}},sorted:function(param,direction){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableSortedFunc);args.first&&(params[args.first]=param),args.second&&(params[args.second]=direction),$scope.sortedFunc(params)},matched:function(item,items){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableSelectedMatchedFunc);return args.first&&(params[args.first]=item),args.second&&(params[args.second]=items),$scope.matchedFunc(params)},upward:function($event){if($event.preventDefault(),!$scope.onUpwardDisable()&&self.isSelected()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnUpward);args.first&&(params[args.first]=getParams(self.selected,"key")),$scope.onUpward(params)}},downward:function($event){if($event.preventDefault(),!$scope.onDownwardDisable()&&self.isSelected()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnUpward);args.first&&(params[args.first]=getParams(self.selected,"key")),$scope.onDownward(params)}},replacement:function($event){if($event.preventDefault(),!($scope.onReplacementDisable()||!self.isSelected()||self.isSelected()>1)){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnReplacement);args.first&&(params[args.first]=getParams(self.selected,"item")),$scope.onReplacement(params)}},"export":function($event){if($event.preventDefault(),!($scope.onExportDisable()||!self.isSelected()||self.isSelected()>1)){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnExport);args.first&&(params[args.first]=getParams(self.selected,"item")),$scope.onExport(params)}},generate:function($event){$event.preventDefault(),$scope.onGenerateDisable()||$scope.onGenerate()},"import":function($event){$event.preventDefault(),$scope.onImportDisable()||$scope.onImport()}},this.showRow=function(param){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableNeedShowRow);return args.first&&(params[args.first]=param),$scope.needShowRow(params)},this.sortMenu=function(){var blockToggleMenu=angular.element(document.getElementsByClassName("block_toggle_menu")[0]);this.showToggle?(blockToggleMenu.css("display","none"),this.showToggle=!1):(blockToggleMenu.css("display","block"),this.showToggle=!0)},this.checkSchedule=function(elem,inxElem){var rule=$attrs.schedule,indexesLink=getIndexesLink(),dynamicLink=$attrs.scheduleDynamicLink;return nwTableScheduler.checkSchedule(rule,indexesLink,elem,inxElem,dynamicLink)},this.rowsSize=function(){return _.isArray(this.items)?this.items.length:_.size(this.items)},this.hasRows=function(){return this.rowsSize()>0},this.isSelected=function(){return this.selected.length},this.hasSelected=function(item,key){return findSelectedIndex(item,key)+1},this.hasSelectedAll=function(){return this.hasRows()&&this.rowsSize()==this.selected.length},this.addSelectedItem=function(item,key){this.selected.push({item:item,key:key})},this.removeSelectedItem=function(item,key){var index=findSelectedIndex(item,key);this.selected.splice(index,1)},this.addSelectedAllItems=function(){_.each(this.items,function(item,key){this.hasSelected(item,key)||this.addSelectedItem(item,key)},this)},this.removeSelectedAllItems=function(){_.each(this.items,function(item,key){this.hasSelected(item,key)&&this.removeSelectedItem(item,key)},this)},this.changeSortParam=function(param){$scope.sortParam!=param?($scope.sortParam=param,$scope.sortDirection=angular.copy($scope.sortDirectionInit)):$scope.sortDirection="desc"==$scope.sortDirection?"asc":"desc",this.action.sorted($scope.sortParam,$scope.sortDirection)},this.getAttr=function(attrName){return $attrs[attrName]},this.getSortParam=function(){return $scope.sortParam},this.getSortDirection=function(){return $scope.sortDirection},this.getDefaultDirection=function(){return $scope.sortDirectionInit}},controllerAs:"nwTable"}}]),nw.directive("nwTableToolbar",["translate",function(){return{restrict:"A",require:"^?nwTable",replace:!0,link:function(){},template:'<div class="nwtable_toolbar" ng-if="!empty"><div class="nwtable_toolbar_title" ng-if="title || needEmptyTitle" ng-bind="title | translate"></div><div class="nwtable_toolbar_toggle_menu" ng-if="isSorted"ng-click="nwTable.sortMenu()"></div><div class="nwtable_toolbar_actions" ng-class="{\'margin-for-toggle\' : isSorted }"><button type="button" class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'customEvent\') && !nwTable.safeCall(\'onCustomEventHide\')" ng-click="nwTable.action.customEvent($event)"ng-class="{\'disabled\' : onCustomEventDisable() || toolbarDisabled()}"ng-bind="customEventName |translate "></button><button class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'secondCustomEvent\') && !nwTable.safeCall(\'onSecondCustomEventHide\')" ng-click="nwTable.action.secondCustomEvent($event)"ng-class="{\'disabled\' : toolbarDisabled()}"ng-bind="secondCustomEventName |translate "></button><button class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'customEventOnSelected\')" ng-click="nwTable.action.customEventOnSelected($event)"ng-class="{\'disabled\' : !nwTable.isSelected() || (nwTable.isAction(\'customEventOnSelected\') && onCustomEventOnSelectedDisable()) || toolbarDisabled(), \'hide\' : onCustomEventOnSelectedHide()}"ng-bind="customEventName |translate "></button><div class="nwtable_toolbar_button_icon"ng-class="{\'disabled_icon\' : !nwTable.isSelected()}"ng-if="nwTable.isAction(\'schedule\')"ng-click="nwTable.action.setSchedule($event)"title="{{\'sched_nav\' | translate}}"><div svg-icon="time"></div></div><div class="nwtable_toolbar_button_icon" ng-if="nwTable.isAction(\'add\')" ng-click="nwTable.action.add($event)"ng-class="{\'disabled_icon\' : (nwTable.isAction(\'addDisable\') && onAddDisable()) || toolbarDisabled(), \'hide\' : nwTable.isAction(\'addHide\') && onAddHide()}"title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div><div class="nwtable_toolbar_button_icon" ng-if="nwTable.isAction(\'message\')" ng-click="nwTable.action.message($event)"ng-class="{\'disabled_icon\' : (nwTable.isAction(\'messageDisable\') && onMessageDisable()) || toolbarDisabled(), \'hide\' : nwTable.isAction(\'messageHide\') && onMessageHide()}"title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div><div class="nwtable_toolbar_button_icon "ng-if="nwTable.isAction(\'generate\')" ng-click="nwTable.action.generate($event)" ng-class="{\'disabled_icon\': onGenerateDisable() || toolbarDisabled()}" title="{{\'pki_generate\' | translate }}"><div svg-icon="add_icon"></div></div><div class="nwtable_toolbar_button_icon "ng-if="nwTable.isAction(\'import\')" ng-click="nwTable.action.import($event)" ng-class="{\'disabled_icon\': onImportDisabled() || toolbarDisabled()}" title="{{\'act_upload\' | translate }}"><div svg-icon="import_icon"></div></div><div class="nwtable_toolbar_button_icon "ng-if="nwTable.isAction(\'replacement\')" ng-click="nwTable.action.replacement($event)" ng-class="{\'disabled_icon\': !nwTable.isSelected() || nwTable.isSelected() > 1 || toolbarDisabled(), \'hide\': nwTable.isAction(\'replacementHide\') && onReplacementHide()}" title="{{\'pki_replacement\' | translate}}"><div svg-icon="replacement_icon"></div></div><div class="nwtable_toolbar_button_icon "ng-if="nwTable.isAction(\'export\')" ng-click="nwTable.action.export($event)" ng-class="{\'disabled_icon\': !nwTable.isSelected() || nwTable.isSelected() > 1 || toolbarDisabled(),\'hide\': nwTable.isAction(\'exportHide\') && onExportHide()}" title="{{\'syslog_export\' | translate}}"><div svg-icon="export_icon"></div></div><div class="nwtable_toolbar_button_icon " ng-if="nwTable.isAction(\'delete\')" ng-click="nwTable.action.delete($event)"ng-class="{\'disabled_icon\' : !nwTable.isSelected() || toolbarDisabled(), \'hide\' : nwTable.isAction(\'deleteHide\') && onDeleteHide()}"title="{{\'act_delete\' | translate}}"><div svg-icon="delete_icon"></div></div><div class="nwtable_toolbar_button_icon big" ng-if="nwTable.isAction(\'upward\')" ng-click="nwTable.action.upward($event)" ng-class="{ \'disabled_icon\' : !nwTable.isSelected() || toolbarDisabled(),  \'hide\' : nwTable.isAction(\'upwardHide\') && onUpwadrHide() }" title="{{ \'wanreserv_up\' | translate}}"><div svg-icon="drop_up" class="big"></div></div><div class="nwtable_toolbar_button_icon big" ng-if="nwTable.isAction(\'downward\')" ng-click="nwTable.action.downward($event)" ng-class="{ \'disabled_icon\' : !nwTable.isSelected() || toolbarDisabled(),  \'hide\' : nwTable.isAction(\'downwardHide\') && onDownwadrHide() }" title="{{ \'wanreserv_down\' | translate}}"><div svg-icon="drop_down" class="big"></div></div></div><div class="nwtable_toolbar_desc" ng-if="desc && !empty" nw-bind-html-compile="desc | translate"></div><div class="nwtable_toolbar_desc" ng-if="empty && emptyDesc" ng-bind="emptyDesc | translate"></div></div>'}}]),nw.directive("nwTableHeadRow",[function(){return{restrict:"A",require:"^^nwTable",link:function($scope,$element,$attrs,$nwTable){$scope.toggleSelectAllRows=function($event){$event.stopPropagation(),$nwTable.hasSelectedAll()?$nwTable.removeSelectedAllItems():$nwTable.addSelectedAllItems()},$scope.isSelectedAllRows=function(){return $nwTable.hasSelectedAll()},$scope.hasRows=function(){return $nwTable.hasRows()}}}}]),nw.directive("nwTableRowSorted",[function(){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element){var $ths=$element.find("th");_.each($ths,function(elem){var $th=angular.element(elem),param=$th.attr("nw-table-sort-param");param?($th.addClass("sortable"),$th.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),$th.attr("ng-class",'getColumnClass("'+param+'")')):$th.addClass("sortable--disable")})},scope:{},link:function($scope,$element,$attrs,$nwTable){$scope.rearrangeColumn=function($event,param){$nwTable.changeSortParam(param)},$scope.getColumnClass=function(param){var result=[],currentParam=$nwTable.getSortParam(),currentDirection=$nwTable.getSortDirection(),defaultDirection=$nwTable.getDefaultDirection();return currentParam==param?(result.push("sortable--active"),result.push("sortable--"+currentDirection)):"asc"==defaultDirection&&result.push("sortable--asc"),result}}}}]),nw.directive("nwTableRowSortedAndSelectAll",[function(){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element,$attrs){var $th=angular.element("<table><tr><th class='nw-table-checkbox-th' ng-hide=\""+$attrs.nwTableRowSelectHide+'"></th></tr></table>').find("th"),$checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectAllRows($event)"),$checkbox.attr("nw-checked","isSelectedAllRows()"),$checkbox.attr("nw-disabled","!hasRows()"),$element.prepend($th.append($checkbox));var $ths=$element.find("th");_.each($ths,function(elem){var $th=angular.element(elem),param=$th.attr("nw-table-sort-param"),showParam=$th.attr("nw-if-param");param?($th.addClass("sortable"),$th.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),$th.attr("ng-class",'getColumnClass("'+param+'")')):$th.addClass("sortable--disable"),showParam&&($th.attr("ng-if",'needShow("'+showParam+'")'),$th.removeAttr("nw-if-param"))})},scope:{},link:function($scope,$element,$attrs,$nwTable){$scope.needShow=function(param){return $nwTable.showRow(param)},$scope.toggleSelectAllRows=function($event){$event.stopPropagation(),$nwTable.hasSelectedAll()?$nwTable.removeSelectedAllItems():$nwTable.addSelectedAllItems()},$scope.isSelectedAllRows=function(){return $nwTable.hasSelectedAll()},$scope.hasRows=function(){return $nwTable.hasRows()},$scope.rearrangeColumn=function($event,param){$nwTable.changeSortParam(param)},$scope.getColumnClass=function(param){var result=[],currentParam=$nwTable.getSortParam(),currentDirection=$nwTable.getSortDirection(),defaultDirection=$nwTable.getDefaultDirection();return currentParam==param?(result.push("sortable--active"),result.push("sortable--"+currentDirection)):"asc"==defaultDirection&&result.push("sortable--asc"),result}}}}]),nw.directive("nwTableRowSelectAll",["nwTableService",function(){return{restrict:"A",require:"^^nwTable",priority:1001,template:function($element,$attrs){var $th=angular.element("<table><tr><th class='nw-table-checkbox-th' ng-hide=\""+$attrs.nwTableRowSelectHide+'"></th></tr></table>').find("th"),$checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectAllRows($event)"),$checkbox.attr("nw-checked","isSelectedAllRows()"),$checkbox.attr("nw-disabled","!hasRows()"),$element.prepend($th.append($checkbox))}}}]),nw.directive("nwTableRow",["nwTableService",function(nwTableService){return{restrict:"A",require:"^^nwTable",link:function($scope,$element,$attrs,$nwTable){var ngRepeat=nwTableService.parse.ngRepeat($attrs.ngRepeat);$scope.toggleSelectRow=function($event,item,key){$event.stopPropagation(),$nwTable.hasSelected(item,key)?$nwTable.removeSelectedItem(item,key):$nwTable.addSelectedItem(item,key)},$scope.isSelectedRow=function(item,key){return $nwTable.hasSelected(item,key)},$scope.editRow=function($event,item,key){$nwTable.action.edit($event,item,key)},$scope.$last&&$nwTable.isReadyBody.resolve(ngRepeat)}}}]),nw.directive("nwTableRowAction",["nwTableService",function(nwTableService){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element,$attrs){function hasAttr(name){return!_.isUndefined($attrs[name])}var ngRepeat=nwTableService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key;hasAttr("nwTableRowSelect")&&function($element,item){function addCheckbox($container,$target,place){var $checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectRow($event, "+item+", "+key+")"),$checkbox.attr("nw-checked","isSelectedRow("+item+", "+key+")"),$target[place]($container.append($checkbox))}$attrs.ngClass?$attrs.$set("ngClass",$attrs.ngClass.replace("}",",")+"'selected': isSelectedRow("+item+")}"):$attrs.$set("ngClass","{'selected': isSelectedRow("+item+")}");var $containers={$table:angular.element("<table><tr><td class='nw-table-checkbox-td' ng-hide=\""+$attrs.nwTableRowSelectHide+'"></td><tr></table>').find("td"),$miniTable:angular.element("<div class='nw-mini-table-checkbox-container'></div>")};addCheckbox($containers.$table,$element,"prepend"),hasAttr("nwMiniTable")&&addCheckbox($containers.$miniTable,$element.children("div"),"prepend")}($element,item),hasAttr("nwTableRowClick")&&function($element,item,key){hasAttr("nwTableEditDisable")?$attrs.ngClass?$attrs.$set("ngClass",$attrs.ngClass.replace("}",",")+"'clickable': !"+$attrs.nwTableEditDisable+"}"):$attrs.$set("ngClass","{'clickable': !"+$attrs.nwTableEditDisable+"}"):$element.addClass("clickable"),$element.attr("ng-click","editRow($event, "+item+", "+key+")")}($element,item,key)},scope:{}}}]),nw.directive("nwTableCheckbox",[function(){return{restrict:"A",replace:!0,scope:{nwChecked:"=nwChecked",nwDisabled:"=nwDisabled"},template:'<div class="nw-table-checkbox-field"><i class="nw-table-checkbox-switch"></i></div>',link:function($scope,$element){var $switch=angular.element($element.find("i"));$scope.$watch("nwChecked",function(value){value?$switch.addClass("nw-table-checkbox-switch--checked"):$switch.removeClass("nw-table-checkbox-switch--checked")}),$scope.$watch("nwDisabled",function(value){_.isUndefined(value)||(value?($element.addClass("nw-table-checkbox-field--disabled"),$switch.addClass("nw-table-checkbox-switch--disabled")):($element.removeClass("nw-table-checkbox-field--disabled"),$switch.removeClass("nw-table-checkbox-switch--disabled")))})}}}]),nw.directive("nwMiniTable",["$injector","nwTableService",function($injector){var scheduler=$injector.has("scheduler")?$injector.get("scheduler"):{isSupport:!1},postLink=function($scope,$element){$element.addClass("nw-mini-table-tr")};return{restrict:"A",compile:function($element,$attrs){function isClickableTable(){return!(_.isUndefined($attrs.nwMiniTableClick)&&_.isUndefined($attrs.nwClickAnywhere)&&_.isUndefined($attrs.ngClick)&&_.isUndefined($attrs.nwTableRowClick))}var statusTemplate,$schedule,$container={$wrapper:angular.element("<div class='nw-mini-table-container'></div>"),$info:angular.element("<div class='nw-mini-table-caption-info-container'></div>"),$status:angular.element("<div class='nw-mini-table-status'></div>"),$icon:angular.element("<div class='nw-mini-table-icon'></div>")};if(!_.isUndefined($attrs.nwMiniTableCaption)){var template="";_.isUndefined($attrs.nwMiniTablePrefix)||(template+='<span ng-init="items = [].concat('+$attrs.nwMiniTablePrefix+')">',template+='   <span ng-repeat="item in items track by $index" class="{{ item.class }}">',template+="       {{ item.content }}",template+='       <svg class="table-mini-icon" ng-if="!!item.icon" svg-icon="{{ item.icon }}"></svg>',template+="   </span>",template+="</span>"),_.isUndefined($attrs.nwMiniTablePrefixBind)||(template+='<span ng-bind="'+$attrs.nwMiniTablePrefixBind+'"></span>'),template+='<span class="{{'+($attrs.nwMiniTableCaptionWrap||"")+'}}" ng-bind="'+$attrs.nwMiniTableCaption+'"></span>',_.isUndefined($attrs.nwMiniTablePostfix)||(template+='<span ng-init="items = [].concat('+$attrs.nwMiniTablePostfix+')">',template+='   <span ng-repeat="item in items track by $index" class="{{ item.class }}">',template+="       {{ item.content }}",template+='       <svg class="table-mini-icon" ng-if="!!item.icon" svg-icon="{{ item.icon }}"></svg>',template+="   </span>",template+="</span>"),_.isUndefined($attrs.nwMiniTablePostfixBind)||(template+='<span ng-bind="'+$attrs.nwMiniTablePostfixBind+'"></span>'),$container.$info.append('<span class="nw-mini-table-caption">'+template+"</span>")}if(!_.isUndefined($attrs.nwMiniTableRows)){var rowsTemplate="";rowsTemplate+='<span class="nw-mini-table-details" ng-init="rows = [].concat('+$attrs.nwMiniTableRows+')">',rowsTemplate+='   <div class="row-mini-table" ng-repeat="row in rows track by $index">',rowsTemplate+='       <span class="row-mini-table__title">{{ row.title }}:&nbsp;</span>',rowsTemplate+='       <span class="row-mini-table__info">{{ row.info }}</span>',rowsTemplate+="   </div>",rowsTemplate+="</span>",$container.$info.append(rowsTemplate)}if(!_.isUndefined($attrs.nwMiniTableDetails)){var shortTemplate="";

shortTemplate+='<span class="nw-mini-table-details">',shortTemplate+='  <span ng-repeat="i in [].concat('+$attrs.nwMiniTableDetails+')">{{i}}<br /></span>',shortTemplate+="</span>",$container.$info.append(shortTemplate)}return _.isUndefined($attrs.nwMiniTableInfoStatus)||($element.addClass("nw-mini-table-tr-info"),statusTemplate="",statusTemplate+='<status-info status="{{'+$attrs.nwMiniTableInfoStatus+'}}"',$attrs.nwMiniTableInfoStatusText&&(statusTemplate+=' text="{{'+$attrs.nwMiniTableInfoStatusText+'}}"'),$attrs.nwMiniTableInfoStatusOn&&(statusTemplate+=' on="{{'+$attrs.nwMiniTableInfoStatusOn+'}}"'),$attrs.nwMiniTableInfoStatusOff&&(statusTemplate+=' off="{{'+$attrs.nwMiniTableInfoStatusOff+'}}"'),$attrs.nwMiniTableInfoStatusPending&&(statusTemplate+=' pending="{{'+$attrs.nwMiniTableInfoStatusPending+'}}"'),$attrs.nwMiniTableInfoStatusDisconnected&&(statusTemplate+=' disconnected="{{'+$attrs.nwMiniTableInfoStatusDisconnected+'}}"'),statusTemplate+="></div>",$container.$status.append(statusTemplate)),_.isUndefined($attrs.nwMiniTableInfo)||($element.addClass("nw-mini-table-tr-info"),$container.$status.attr("nw-bind",$attrs.nwMiniTableInfo)),_.isUndefined($attrs.nwMiniTableChooseIcon)||($container.$connections=angular.element("<div class=nw-mini-table-activate-icon ><svg svg-icon='"+$attrs.nwMiniTableChooseIcon+"'></svg></div>"),_.isUndefined($attrs.nwMiniTableActivateIcon)||$container.$connections.attr("ng-class","{'enable':"+$attrs.nwMiniTableActivateIcon+"}"),$container.$wrapper.append($container.$connections)),$container.$arrow=angular.element("<div class='nw-mini-table-arrow'><svg svg-icon='arrow_right'></svg></div>"),_.isUndefined($attrs.nwMiniTableClick)||$container.$wrapper.attr("ng-click",$attrs.nwMiniTableClick),function(){return $attrs.nwMiniTableFull||!$attrs.nwMiniTableDetails&&!$attrs.nwMiniTableCaption}()?($element.addClass("nw-mini-table-opening"),$element.bind("click",function(){$element.toggleClass("nw-mini-table-open")})):$element.addClass("nw-mini-table-not-opening"),$container.$wrapper.append($container.$info),scheduler.isSupport&&($schedule=angular.element("<div nw-table-schedule-column='mini'></div>"),$container.$wrapper.append($schedule)),$container.$wrapper.append($container.$status),_.isUndefined($attrs.nwMiniTableIcon)?isClickableTable()&&$container.$wrapper.append($container.$arrow):($container.$icon.attr("nw-bind-html-compile",$attrs.nwMiniTableIcon),$container.$wrapper.append($container.$icon)),$element.append($container.$wrapper),$element.addClass("nw-mini-table-tr"),postLink},priority:1002}}]),nw.factory("nwTableService",function(){function Repeat(ngRepeat){for(this._tokens=this.parse(ngRepeat).split(" "),this._iterator=0,this.isNext("in")?(this.key="$index",this.item=this.current()):(this.key=this.current(),this.item=this.getNext()),this.delim=this.getNext(),this.items=this.getNext();this.hasNext()&&-1===["|","track"].indexOf(this.getNext());)this.items+=this.current()}function AttrFunction(attr){this._args=this.parse(attr),this._iterator=0,this.hasCurrent()&&(this.first=this.current()),this.hasNext()&&(this.second=this.getNext())}var cache={};Repeat.prototype.parse=function(ngRepeat){var delimiterChars=/[(,)]/g;return ngRepeat.replace(delimiterChars,"")},Repeat.prototype.current=function(){return this._tokens[this._iterator]},Repeat.prototype.isNext=function(name){return this._tokens[this._iterator+1]===name},Repeat.prototype.getNext=function(){return this._tokens[++this._iterator]},Repeat.prototype.getValue=function(){return this._tokens.join(" ")},Repeat.prototype.hasNext=function(){return this._iterator<this._tokens.length-1},AttrFunction.prototype.parse=function(attr){var reg=/\((.*)\)/,matches=attr.match(reg);return matches&&matches.length&&matches[1]?matches[1].replace(/\s/g,"").split(","):[]},AttrFunction.prototype.hasCurrent=function(){return this._iterator<this._args.length},AttrFunction.prototype.current=function(){return this._args[this._iterator]},AttrFunction.prototype.getNext=function(){return this._args[++this._iterator]},AttrFunction.prototype.hasNext=function(){return this._iterator<this._args.length-1};var parse=function(){return{ngRepeat:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new Repeat(attr)},attrFunction:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new AttrFunction(attr)}}}();return{parse:parse}})}();