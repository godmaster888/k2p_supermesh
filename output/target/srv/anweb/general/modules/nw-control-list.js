"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}!function(){var nw=angular.module(regdep("nw-control-list"),[]);nw.directive("nwControlList",["$q",function($q){return{restrict:"A",scope:{selectedList:"=nwControlListSelectedList"},compile:function($element,$attrs){var params={selected:"nwControlListSelected"},$item=$element.children();(function(name){return _.has($attrs,params[name])})("selected")&&$item.attr("nw-control-list-item-selected","")},controller:function($scope){function findSelectedIndex(item,key){var inx,items=self.selected;for(inx=0;inx<items.length;inx++){if(items[inx].key==key)return inx;if(_.isEqual(angular.copy(items[inx].item),angular.copy(item)))return inx}return-1}var self=this;this.items,this.selected=$scope.selectedList?$scope.selectedList:[],this.isReadyBody=$q.defer(),this.isReadyBody.promise.then(function(ngRepeat){$scope.$parent.$watch(ngRepeat.items,function(newValue,oldValue){(_.isUndefined(self.items)||newValue!==oldValue)&&(self.items=newValue),self.selected.length&&newValue!==oldValue&&self.selected.splice(0)},!0)}),this.hasSelected=function(item,key){return findSelectedIndex(item,key)+1},this.addSelectedItem=function(item,key){self.selected.push({item:item,key:key})},this.removeSelectedItem=function(item,key){var index=findSelectedIndex(item,key);self.selected.splice(index,1)},$scope.$watch("nwControlList.selected",function(newValue){_.isUndefined(newValue)||_.isUndefined($scope.selectedList)||($scope.selectedList=newValue)},!0)},controllerAs:"nwControlList"}}]),nw.directive("nwControlListItem",["nwControlListService","$compile",function(nwControlListService){var params={selected:"nwControlListItemSelected",title:"nwControlListItemTitle",subtitle:"nwControlListItemSubtitle",subtitle2:"nwControlListItemSubtitle2",disabled:"nwControlListItemDisabled"};return{restrict:"A",require:"^^nwControlList",compile:function($element,$attrs){function hasAttr(name){return _.has($attrs,params[name])}var ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key,$container={$primary:angular.element("<div class='nw-control-list_item_primary'></div>"),$content:angular.element("<div class='nw-control-list_item_content'></div>")};return hasAttr("title")&&$container.$content.append('<div class="nw-control-list_item_title" nw-bind-html-compile='+$attrs[params.title]+"></div>"),hasAttr("subtitle")&&$container.$content.append('<div class="nw-control-list_item_subtitle" nw-bind-html-compile='+$attrs[params.subtitle]+"></div>"),hasAttr("subtitle2")&&$container.$content.append('<div class="nw-control-list_item_subtitle" nw-bind-html-compile='+$attrs[params.subtitle2]+"></div>"),$element.addClass("nw-control-list_item"),hasAttr("selected")&&($element.attr("ng-click","toggleSelectItem($event, "+item+", "+key+")"),$element.attr("ng-class","{'nw-control-list_item--selected' : isSelectedItem("+item+", "+key+")}")),$element.append($container.$primary),$element.append($container.$content),function($scope,$element,$attrs,$nwControlList){function isDisabledItem(item,key){var _$scope$$eval;return $scope.$eval($attrs[params.disabled],(_$scope$$eval={},_defineProperty(_$scope$$eval,ngRepeat.key,key),_defineProperty(_$scope$$eval,ngRepeat.item,item),_$scope$$eval))}var ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat);$scope.toggleSelectItem=function($event,item,key){$event.stopPropagation(),isDisabledItem(item,key)||($nwControlList.hasSelected(item)?$nwControlList.removeSelectedItem(item,key):$nwControlList.addSelectedItem(item,key))},$scope.isSelectedItem=function(item,key){return $nwControlList.hasSelected(item,key)},$scope.isDisabledItem=isDisabledItem,$scope.$last&&$nwControlList.isReadyBody.resolve(ngRepeat)}},priority:1001}}]),nw.directive("nwControlListItemSelected",["nwControlListService",function(nwControlListService){return{restrict:"A",require:"^^nwControlList",template:function($element,$attrs){var $primary=angular.element($element[0].querySelector(".nw-control-list_item_primary")),ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key,$checkbox=angular.element("<div nw-control-list-checkbox></div>");$checkbox.attr("nw-checked","isSelectedItem("+item+", "+key+")"),$checkbox.attr("nw-disabled","isDisabledItem("+item+", "+key+")"),$primary.append($checkbox)}}}]),nw.directive("nwControlListCheckbox",[function(){return{restrict:"A",replace:!0,scope:{nwChecked:"=nwChecked",nwDisabled:"=nwDisabled"},template:'<div class="nw-control-list-checkbox_field"><i class="nw-control-list-checkbox_switch"></i></div>',link:function($scope,$element){var $switch=angular.element($element.find("i"));$scope.$watch("nwChecked",function(value){value?$switch.addClass("nw-control-list-checkbox_switch--checked"):$switch.removeClass("nw-control-list-checkbox_switch--checked")}),$scope.$watch("nwDisabled",function(value){_.isUndefined(value)||(value?($element.addClass("nw-control-list-checkbox_field--disabled"),$switch.addClass("nw-control-list-checkbox_switch--disabled")):($element.removeClass("nw-control-list-checkbox_field--disabled"),$switch.removeClass("nw-control-list-checkbox_switch--disabled")))})}}}]),nw.factory("nwControlListService",function(){function Repeat(ngRepeat){for(this._tokens=this.parse(ngRepeat).split(" "),this._iterator=0,this.isNext("in")?(this.key="$index",this.item=this.current()):(this.key=this.current(),this.item=this.getNext()),this.delim=this.getNext(),this.items=this.getNext();this.hasNext()&&-1===["|","track"].indexOf(this.getNext());)this.items+=this.current()}function AttrFunction(attr){this._args=this.parse(attr),this._iterator=0,this.hasCurrent()&&(this.first=this.current()),this.hasNext()&&(this.second=this.getNext())}var cache={};Repeat.prototype.parse=function(ngRepeat){var delimiterChars=/[(,)]/g;return ngRepeat.replace(delimiterChars,"")},Repeat.prototype.current=function(){return this._tokens[this._iterator]},Repeat.prototype.isNext=function(name){return this._tokens[this._iterator+1]===name},Repeat.prototype.getNext=function(){return this._tokens[++this._iterator]},Repeat.prototype.getValue=function(){return this._tokens.join(" ")},Repeat.prototype.hasNext=function(){return this._iterator<this._tokens.length-1},AttrFunction.prototype.parse=function(attr){var reg=/\((.*)\)/,matches=attr.match(reg);return matches&&matches.length&&matches[1]?matches[1].replace(/\s/g,"").split(","):[]},AttrFunction.prototype.hasCurrent=function(){return this._iterator<this._args.length},AttrFunction.prototype.current=function(){return this._args[this._iterator]},AttrFunction.prototype.getNext=function(){return this._args[++this._iterator]},AttrFunction.prototype.hasNext=function(){return this._iterator<this._args.length-1};var parse=function(){return{ngRepeat:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new Repeat(attr)},attrFunction:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new AttrFunction(attr)}}}();return{parse:parse}})}();