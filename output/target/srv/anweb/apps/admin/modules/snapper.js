"use strict";var snap=angular.module(regdep("snapper"),[]);snap.service("snapper",["$timeout","$interval",function($timeout,$interval){this.snap={};var blocked=!1,self=this,maxWidth=autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP?699:1024,initInterval=$interval(function(){var bodyContent=document.getElementById("body-content");if(bodyContent){$interval.cancel(initInterval);var maxPosition=window.innerWidth>500?310:270;snap=new Snap({element:document.getElementById("body-content"),maxPosition:maxPosition,disable:"right"}),self.snap=snap;var wrapper=autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP||autoconf.BR2_PACKAGE_ANWEB_EU_ADMIN_APP||autoconf.BR2_PACKAGE_ANWEB_MEGAFON_APP?document.getElementsByClassName("page-block")[0]:document.getElementById("wrapper"),snapOverlay=document.getElementById("overlay-blackout");snap.on("open",function(){blocked||(snapOverlay.style.zIndex=9999,snapOverlay.style.opacity=(maxPosition/(maxPosition+195)).toFixed(2),wrapper.style.overflow="hidden")}),snap.on("close",function(){blocked||($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto")}),snap.on("start",function(){if(blocked=window.innerWidth>maxWidth?!0:!1,!blocked){var state=snap.state();null!=state.info.flick&&(snapOverlay.style.transition="none")}}),snap.on("end",function(){if(!blocked){snapOverlay.style.transition="opacity 0.3s ease";var state=snap.state();"right"==state.info.towards?state.info.flick?(snapOverlay.style.zIndex=9999,snapOverlay.style.opacity=(maxPosition/(maxPosition+195)).toFixed(2),wrapper.style.overflow="hidden"):($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto"):1==state.info.flick&&($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto")}}),snap.on("drag",function(){if(!blocked){var transformBC=bodyContent.style.transform,shiftBC=parseInt(transformBC.substr(12,transformBC.length).split(",")[0]);shiftBC>15?(snapOverlay.style.zIndex=9999,wrapper.style.overflow="hidden"):(snapOverlay.style.zIndex=-1,wrapper.style.overflow="auto"),maxPosition>=shiftBC&&(snapOverlay.style.opacity=(shiftBC/(maxPosition+195)).toFixed(2))}});var startY=0,menu=document.getElementsByClassName("mmenu")[0];if(!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&function(){var iosVersion;try{return iosVersion=parseInt(navigator.userAgent.match(/OS (\d{1,2})_\d(_\d)? like Mac OS/)[1]),13>iosVersion}catch(e){return!1}}()){var preventScrollIfNeeded=function(event,scrollingElement){var clientY=event.targetTouches[0].clientY-startY;0===scrollingElement.scrollTop&&clientY>0&&event.preventDefault(),isTotallyScrolled(scrollingElement)&&0>clientY&&event.preventDefault()},isTotallyScrolled=function(elem){return elem.scrollHeight-elem.scrollTop<=elem.clientHeight};wrapper.addEventListener("touchstart",function(event){1===event.targetTouches.length&&(startY=event.targetTouches[0].clientY)},!1),wrapper.addEventListener("touchmove",function(event){1===event.targetTouches.length&&preventScrollIfNeeded(event,wrapper)},!1),menu.addEventListener("touchstart",function(event){1===event.targetTouches.length&&(startY=event.targetTouches[0].clientY)},!1),menu.addEventListener("touchmove",function(event){1===event.targetTouches.length&&preventScrollIfNeeded(event,menu)},!1)}}},500)}]);