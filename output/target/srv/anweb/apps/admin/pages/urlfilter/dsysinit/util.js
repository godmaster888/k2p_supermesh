"use strict";!function(){angular.module("app").service("urlfilterUtil",["cpe","device","funcs",function(cpe,device,funcs){function push(settings){function prepareInitConfig(nativeConfig){var initConfig=converter.nativeToDsysinit(nativeConfig);return nativeConfig.config.__id||funcs.setValue("Device.Services.URLFilter",{},initConfig),initConfig}settings.config.IsDNSFilter=autoconf.BR2_PACKAGE_ANWEB_DNS_FILTER,nativeConfig.config.IsDNSFilter=autoconf.BR2_PACKAGE_ANWEB_DNS_FILTER;var curDsysinitConfig=converter.nativeToDsysinit(settings),initDsysinitConfig=prepareInitConfig(nativeConfig),diff=funcs.newConfig.makeDiff(initDsysinitConfig,curDsysinitConfig,dsysinitAttrs);return cpe.ApplyDifference(diff)}function makeHelper(){var workList=function(list){return _.map(list,function(elem){var obj={};return obj=angular.copy(elem)})}(nativeConfig.list);return new Helper(nativeConfig.config,nativeConfig.list,workList)}var dsysinitConfig=null,dsysinitAttrs=null,nativeConfig=null,serviceURL="Device.Services.URLFilter.",converter=device.urlfilter.converter,Helper=device.urlfilter.Helper;return{pull:function(){function success(response){return dsysinitConfig=funcs.buildTree(response[0].result.ParameterList),dsysinitAttrs=funcs.buildTreeAttributes(response[1].result.ParameterList),dsysinitConfig.IsDNSFilter=autoconf.BR2_PACKAGE_ANWEB_DNS_FILTER,nativeConfig=converter.dsysinitToNative(dsysinitConfig),angular.copy(nativeConfig),Promise.resolve()}return Promise.all([cpe.GetParameterValues([serviceURL]),cpe.GetParameterAttributes([serviceURL])]).then(success)},push:push,makeHelper:makeHelper,needPrepareSettings:function(){return!1}}}])}();