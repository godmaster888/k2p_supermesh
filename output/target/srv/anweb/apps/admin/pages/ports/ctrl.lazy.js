"use strict";angular.module("app").controllerProvider.register("PortsCtrl",["$scope","$state","translate","ngDialog","funcs","PortSettingsUtil",function($scope,$state,translate,ngDialog,funcs,util){function init(){function success(){$scope.preload=!1,helper=util.makeHelper(),updatePorts(helper.getData()),isSubscribe||(isSubscribe=!0,util.subscribe(updatePorts,$scope)),$scope.$emit("pageload"),$scope.$watch("ports",function(){return $scope.ports})}function updatePorts(data){$scope.ports=data}util.pull().then(success)["catch"](errorPull)}function errorPull(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"})}var helper,isSubscribe=!1;!function(){function success(){helper=util.makeHelper(),$scope.ports=helper.getData(),$scope.preload=!0,$scope.$emit("pageload")}util.preload().then(success)["finally"](init)}(),$scope.edit=function(port){ngDialog.open({template:"/admin/dialogs/port_settings/dialog.tpl.html",className:"port_settings_dialog",controller:"PortSettingsDialogCtrl",resolve:funcs.getLazyResolve("/admin/dialogs/port_settings/ctrl.lazy.js","PortSettingsDialogCtrl"),data:{port:port,notEdit:!port.advertisement||"SFP"==port.alias},scope:$scope}).closePromise.then(init)},$scope.getPortAdmin=function(port){return $scope.preload?"-":translate(port.enable?"st_enabled":"st_disabled")},$scope.getPortStatus=function(port){return $scope.preload?"-":translate("portctrl_status_"+port.status.toLowerCase())},$scope.getFlowControl=function(port){return $scope.preload?"-":"Up"!==port.status||"Unknown"===port.flowControl?"-":"Off"==port.flowControl?translate("portctrl_status_off"):port.flowControl},$scope.getSpeed=function(port){return $scope.preload?"-":"Up"!==port.status?"-":"0M-Full"==port.speed||"0M-Half"==port.speed?"auto":port.speed},$scope.getShort=function(port){return $scope.preload?"-":$scope.getPortStatus(port)},$scope.getPortClass=function(port){return $scope.preload?"":"status "+port.status},$scope.getAutonegotiation=function(port){return $scope.preload?"-":"autonegotiation"in port?translate(port.autonegotiation?"on":"off"):"-"}}]);