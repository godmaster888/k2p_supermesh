"use strict";!function(){angular.module("app").controller("loadBalancingInfoCtrl",["$scope","$state","funcs","loadBalancingUtil","translate",function($scope,$state,funcs,util,translate){function activate(){util.pull().then(function(){balance.data=util.getData(),util.subscribeInfo(void 0,function(response){balance.data.Rules=response.Rules},$scope),balance.isActivate=!0,$scope.$emit("pageload")})["catch"](function(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"})})}function add(){$state.go(currentState+".balanceParam.add")}function edit(item,key){$state.go(currentState+".balanceParam.edit",{inx:key})}function getIfaceName(value,type){var ifaces="LAN"==type?balance.data.LAN:balance.data.WAN,iface=_.findWhere(ifaces,{Value:value});return iface?iface.Name:"-"}$scope.balanceInfo={data:null,add:add,edit:edit,remove:function(items,keys){if(confirm(translate("qossw_remove_rules_warning_answer"))){var overlay=$scope.overlay.circular,overlayId=overlay.start();util.removeRules(keys).then(activate)["catch"](function(){$state.go("error",{code:"msg_push_error",message:"msg_error_desc"})})["finally"](overlay.stop.bind(overlay,overlayId))}},getIfaceName:getIfaceName,getConnsList:function(wan){if(0==wan.length)return"-";var list=_.map(wan,function(elem){return getIfaceName(elem.Link,"WAN")});return list.join(",")},isActivate:!1};var balance=$scope.balanceInfo,currentState=$state.current.name.split(".");currentState.pop(),currentState=currentState.join("."),activate()}])}();