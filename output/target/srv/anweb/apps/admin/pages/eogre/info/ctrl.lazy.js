"use strict";!function(){angular.module("app").controllerProvider.register("EoGreInfoCtrl",["$scope","$state","EoGreUtil","translate","funcs",function($scope,$state,util,translate){function activate(overlayId){util.pull().then(function(){eogre.data=util.getData(),eogre.connList=util.getConnList(),util.subscribeInfo(function(response){eogre.data=response.Tunnels},$scope)})["catch"](errorPull)["finally"](function(){overlayId&&overlay.stop(overlayId),eogre.isActivate||($scope.$emit("pageload"),eogre.isActivate=!0)})}function add(){$state.go(currentState+".add")}function edit(item){$state.go(currentState+".edit",{inx:item.__id})}function errorPull(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"})}function errorPush(){$state.go("error",{code:"msg_push_error",message:"msg_error_desc"})}function getIface(link){return _.find(eogre.connList,{value:link}).name}$scope.eogre={data:null,connList:null,add:add,edit:edit,remove:function(items,keys){if(confirm(translate("ipsec_remove_rules_warning"))){var overlayId=overlay.start();util.removeTunnels(keys).then(function(){activate(overlayId)},function(){overlay.stop(overlay,overlayId),errorPush()})}},isActivate:!1,getIface:getIface,getMiniTableShort:function(item){var result=[];return item.Name&&result.push(translate("name")+": "+item.Name),item.IP&&result.push(translate("iface")+": "+translate(getIface(item.IP))),result}};var eogre=$scope.eogre,overlay=$scope.overlay.circular,currentState=$state.current.name.split(".");currentState.pop(),currentState=currentState.join("."),activate()}])}();