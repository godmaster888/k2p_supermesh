"use strict";!function(){angular.module("app").service("sambaUtil",["funcs","device","devinfo","cpe",function(funcs,device,devinfo,cpe){function apply(settings){var data=converter.nativeToDsysinit(settings),__initConfig=converter.nativeToDsysinit(__initSamba),diff=funcs.newConfig.makeDiff(__initConfig,data,attrs);return _.isEmpty(diff)?Promise.resolve():cpe.ApplyDifference(diff).then(function(){return cpe.GetParameterValues([samba]).then(function(response){var data=funcs.buildTree(response.result.ParameterList),dirs=data.Device.Services.Samba.Dirs,error=helper.isErrorInvalidPath(dirs);return error?Promise.reject(error):Promise.resolve()})})}function isChange(settings){if(!settings)return!1;var changes=funcs.getChangesWithRemoved(__initSamba,angular.copy(settings));return!_.isEmpty(changes)}function getSettings(){return config?config:{}}var config,attrs,__initSamba,samba="Device.Services.Samba.",converter=device.samba.converter,helper=new device.samba.Helper;return{pull:function(){function success(response){var data=funcs.buildTree(response[0].result.ParameterList);attrs=funcs.buildTreeAttributes(response[1].result.ParameterList),config=converter.dsysinitToNative(data);var dirs=data.Device.Services.Samba.Dirs;return config.InvalidPath=_.some(dirs,function(dir){return 0==dir.ValidPath}),__initSamba=funcs.deepClone(config),Promise.resolve()}return Promise.all([cpe.GetParameterValues([samba]),cpe.GetParameterAttributes([samba])]).then(success)},apply:apply,getSettings:getSettings,isChange:isChange}}])}();