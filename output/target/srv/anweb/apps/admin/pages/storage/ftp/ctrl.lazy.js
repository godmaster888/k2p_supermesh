"use strict";!function(){function storageFtpCtrl($scope,$state,funcs,translate,ngDialog,snackbars,util){function init(){util.pull().then(function(){$scope.ftp=util.getSettings(),__backupFtp=angular.copy($scope.ftp),$scope.$emit("pageload")})}var __backupFtp=null;$scope.isInvalidUSBPath=!1,init(),$scope.saveEnabled=function(){if(!$scope.ftp)return!1;var changes=funcs.getChangesWithRemoved(__backupFtp,angular.copy($scope.ftp));return!_.isEmpty(changes)},_.extend($scope,{openFileBrowser:function(path){ngDialog.open({template:"dialogs/filebrowser/dialog.tpl.html",controller:"DialogFileBrowserCtrl",resolve:funcs.getLazyResolve("dialogs/filebrowser/ctrl.lazy.js","DialogFileBrowserCtrl"),data:{title:"",Path:path},scope:$scope}).closePromise.then(function(data){$scope.ftp.DirPath=data.value})},apply:function(){function error(error){$scope.ftp.Enable?error&&"invalid_usb_path"==error.name?($scope.ftp.InvalidPath=!0,alert(translate("syslog_invalid_usb_path")),snackbars.add("syslog_invalid_usb_path")):snackbars.add("msg_rpc_write_error"):snackbars.add("msg_rpc_write_success"),init()}if(!$scope.storage_ftp_form.$invalid){var overlay=$scope.overlay.circular,overlayId=overlay.start();util.apply($scope.ftp).then(function(){$scope.ftp.InvalidPath=!1,snackbars.add("msg_rpc_write_success"),init()})["catch"](error)["finally"](overlay.stop.bind(overlay,overlayId))}}})}angular.module("app").controllerProvider.register("storageFtpCtrl",storageFtpCtrl),storageFtpCtrl.$inject=["$scope","$state","funcs","translate","ngDialog","snackbars","storageFtpUtil"]}();