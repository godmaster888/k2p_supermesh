"use strict";!function(){function TorrentController($scope,funcs,snackbars,util,ngDialog,translate){function activate(){var data=util.getConfig();setStorage(data),$scope.transmission=data.Transmission,$scope.transmissionInitial=funcs.deepClone($scope.transmission),$scope.rpcPortBackup=$scope.transmission.RpcPort,util.subscribeInfo(setStorage,$scope),$scope.$emit("pageload")}function setStorage(storageResponse){$scope.usbStorage=storageResponse.UsbStorage,$scope.usbStorageList=storageResponse.UsbStorageList}function pull(){util.pull().then(activate)}function push(){var overlay=$scope.overlay.circular,overlayId=overlay.start();util.push($scope.transmission).then(function(){$scope.transmission.InvalidPath=!1,pull(),snackbars.add("msg_rpc_write_success")})["catch"](function(response){$scope.transmission.Enable?response&&"invalid_usb_path"==response.name?($scope.transmission.InvalidPath=!0,alert(translate("trans_invalid_usb_path_note")),snackbars.add("trans_invalid_usb_path_note")):snackbars.add("msg_rpc_write_error"):snackbars.add("msg_rpc_write_success"),pull()})["finally"](overlay.stop.bind(overlay,overlayId))}$scope.usbStorageList=[],$scope.refreshStorage=function(){util.refreshStorage(setStorage)},$scope.getTransmissionLink=function(){var location=document.location;return"http://"+location.hostname+":"+$scope.rpcPortBackup},$scope.validatePass=function(value){if(value){var reLegal=/^[А-яЁё\x20-\x7E]*$/g;return value.length>32?"msg_invalid_password_length":reLegal.test(value)?null:"msg_password_contains_illegal"}},$scope.saveEnabled=function(){if(!$scope.usbStorage)return!1;var changes=funcs.getChanges($scope.transmissionInitial,$scope.transmission);return!_.isEmpty(changes)},$scope.save=function(){!$scope.transmission_form.$invalid&&$scope.saveEnabled()&&push()},$scope.openFileBrowser=function(path){$scope.usbStorage&&ngDialog.open({template:"dialogs/filebrowser/dialog.tpl.html",controller:"DialogFileBrowserCtrl",resolve:funcs.getLazyResolve("dialogs/filebrowser/ctrl.lazy.js","DialogFileBrowserCtrl"),data:{title:"",path:path},scope:$scope}).closePromise.then(function(data){data.value&&($scope.transmission.DeviceDir=data.value)})},$scope.needRemoteAccess=function(){return autoconf.BR2_PACKAGE_ANWEB_CUSTOM_KOREA_21883&&autoconf.BR2_PACKAGE_ANWEB_REMOTE_ACCESS},$scope.supportedParam=function(param){return void 0!=$scope.transmission[param]},$scope.supportedParamDsysinit=function(param){return void 0!=$scope.transmission[param]},pull()}angular.module("app").controllerProvider.register("storageTorrentController",TorrentController),TorrentController.$inject=["$scope","funcs","snackbars","torrentUtil","ngDialog","translate"]}();