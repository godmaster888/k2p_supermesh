"use strict";!function(){angular.module("app").factory("summaryUsb",["utilSummaryUsb","$state","translate","summaryConstants",function(util,$state,translate){function commonUsbHandler(data){if(data){var input=util.convert(data);usbInfo.devices=function(input){return _.chain(input).map(function(item,section){return handlers[section]&&("dongle"!=section||"dongle"==section&&!embedModem)?handlers[section](item):null}).flatten().compact().value()}(input),usbInfo.embedDevices=function(input){return _.chain(input).map(function(item,section){return handlers[section]&&"dongle"==section&&embedModem?handlers[section](item):null}).flatten().compact().value()}(input),usbInfo.isEmpty=!usbInfo.devices.length,usbInfo.embedIsEmpty=!usbInfo.embedDevices.length}}function get(){return usbInfo?usbInfo:usbInfo={area:util.getAreas(),devinfoHandler:commonUsbHandler,devices:[],embedDevices:[],isEmpty:!0,embedIsEmpty:!0}}var usbInfo=null,backupDongleData=null,embedModem=autoconf.ANWEB_RENAME_USB_TO_LTE,handlers={dongle:function(input){return input?backupDongleData=angular.copy(input):input=backupDongleData,input?_.isArray(input)?_.map(input,function(item){if(!item.status)return null;var usbmodemLink="usbmodem.basic";return{icon:embedModem?"sim_card":"usb_modem",name:item.vendor.toUpperCase()+" "+item.model,link:_.has(item,"__id")?$state.href(usbmodemLink,{modem:item.__id}):$state.href(usbmodemLink),imei:item.imei,imsi:item.imsi,actual_mode:item.actual_mode,percent:item.percent}}):input.status?{icon:embedModem?"sim_card":"usb_modem",name:input.vendor.toUpperCase()+" "+input.model,link:_.has(item,"__id")?$state.href("usbmodem.basic",{modem:item.__id}):$state.href("usbmodem.basic"),imei:input.imei,imsi:input.imsi,actual_mode:input.actual_mode,percent:input.percent}:null:null},storage:function(input){return _.map(input,function(item){return _.isUndefined(item.Device)?null:{icon:"usb",name:item.Device,Mountpoint:item.Mountpoint,link:$state.href(autoconf.BR2_PACKAGE_ANWEB_EU_ADMIN_APP?"settings.storage.filebrowser":"storage.filebrowser")}})},print:function(input){return input&&input.enable&&input.connected?{icon:"print",name:translate("summary_usb_printer"),link:$state.href("printserver")}:null}};return{get:get}}])}();