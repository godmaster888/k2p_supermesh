"use strict";!function(){angular.module("app").service("tracerouteUtil",["funcs","$timeout","cpe","pingTracerouteFlow",function(funcs,$timeout,cpe,flow){function stopTraceroute(){tracerouteConnection&&tracerouteConnection.close&&(tracerouteConnection.close(),tracerouteConnection=null)}function authCheck(){return cpe.GetParameterValues(["Device.Users.CurrentUser."])}var tracerouteConnection=null;return{init:function(){return Promise.resolve()},startTraceroute:function(params,flowDetector,$scope){var traceroute=params.is_ipv6?"traceroute6":"traceroute",load={method:traceroute,params:{host:params.host}};return _.has(params,"nqueries")&&(load.params["-q"]=params.nqueries.toString()),_.has(params,"max_ttl")&&(load.params["-m"]=params.max_ttl.toString()),_.has(params,"waittime")&&(load.params["-w"]=params.waittime.toString()),load=JSON.stringify(load),authCheck().then(function(){tracerouteConnection=flow.start(load,flowDetector,$scope)})},stopTraceroute:stopTraceroute}}])}();