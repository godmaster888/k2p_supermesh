"use strict";!function(){angular.module("app").service("systemNtpUtil",["cpe","devinfo","device","funcs",function(cpe,devinfo,device,funcs){function apply(config){var diff=funcs.newConfig.makeDiff(__initConfig,config,attrs);return _.isEmpty(diff)?Promise.resolve():cpe.ApplyDifference(diff)}function makeHelper(){return new device.systemTime.Helper(config,attrs)}var config=null,attrs=null,__initConfig=null,paths=device.systemTime.constants.paths;return{pull:function(){function success(response){return config=funcs.buildTree(response[0].result.ParameterList),attrs=funcs.buildTreeAttributes(response[1].result.ParameterList),__initConfig=funcs.deepClone(config),Promise.resolve()}return Promise.all([cpe.GetParameterValues([paths.time,paths.ntp]),cpe.GetParameterAttributes([paths.time,paths.ntp])]).then(success)},apply:apply,subscribeTime:function(cb,$scope){devinfo.subscribe(paths.time,function(response){if(response&&response[paths.time]){var time=funcs.fetchBranch(response[paths.time],paths.time);cb&&cb(time)}},$scope)},makeHelper:makeHelper}}])}();