"use strict";!function(){angular.module("app").controllerProvider.register("wifiWMMCtrl",["$scope","$state","ngDialog","translate",function($scope,$state,ngDialog,translate){function wifiPull(){device.wifi.pullWMM(function(error){if(error)return void $state.go("error",{code:"msg_pull_error",message:"msg_error_desc"});$scope.band.list.length=0,device.wifi.hasBand("2.4GHz")&&$scope.band.list.push("2.4GHz"),device.wifi.hasBand("5GHz")&&$scope.band.list.push("5GHz");var freq=$state.params.freq?$state.params.freq:_.first($scope.band.list);$scope.band.state=freq,device.wifi.setBandFreq(freq),$scope.wmm=device.wifi.getBand(0,freq),$scope.data=$scope.wmm.wmm.data,$scope.mode.value=getMode($scope.data.settings),$scope.mode.support=!0,$scope.isActivate=!0,$scope.$emit("pageload")})}function load(freq){var nowHref=location.href.split("#")[1],freqArr=nowHref.split("=");freqArr[1]=freq;var newHref=freqArr.join("=");location.href="#"+newHref}function getMode(settings){return settings.Mode?settings.Mode:"Auto"}var device=$scope.device;wifiPull(),$scope.isActivate=!1,$scope.band={list:[],state:null,change:function(freq){$scope.band.state=freq,device.wifi.setBandFreq(freq),$scope.wmm=device.wifi.getBand(0,freq),$scope.data=$scope.wmm.wmm.data,$scope.mode.value=getMode($scope.data.settings),load(freq),$state.go(".",{freq:freq},{notify:!1})},load:load,translateBand:function(key){return translate("2.4GHz"==key?"24ghz":"5ghz")}},$scope.mode={support:!1,value:null,change:function(){switch(this.value){case"Auto":$scope.data.settings.Enable=!0,$scope.data.settings.Mode="Auto";break;case"Manual":$scope.data.settings.Enable=!0,$scope.data.settings.Mode="Manual";break;case"Disabled":$scope.data.settings.Enable=!1;break;default:return}$scope.apply()}},$scope.getCWValue=function(key){return(1<<key)-1},$scope.transcripts={BK:"Background",BE:"Best Effort",VI:"Video",VO:"Voice"},$scope.apply=function(){var overlay=$scope.overlay.circular,overlayId=overlay.start();device.wifi.push(function(error){overlay.stop(overlayId),error?$state.go("error",{code:"msg_push_error",message:"msg_error_desc"}):wifiPull()})},$scope.edit=function(item,key,type){ngDialog.open({template:"/admin/dialogs/wifi_wmm_edit/dialog.tpl.html",className:"wifi_wmm_edit_dialog",controller:WifiWMMEditDialogCtrl,data:{key:key,type:type},scope:$scope}).closePromise.then(function(data){data.value&&$scope.apply()})},$scope.getModeList=function(){return[{name:"auto",value:"Auto"},{name:"manual",value:"Manual"}]}}])}();