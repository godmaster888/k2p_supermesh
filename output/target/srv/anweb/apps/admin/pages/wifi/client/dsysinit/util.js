"use strict";!function(){angular.module("app").service("wifiClientUtil",["devinfo","funcs",function(devinfo,funcs){var constants={CONFIG_WIFI_SITES:"Device.Statistics.WiFi.Radio.*.SiteSurvey.",CONFIG_WIFI_STATISTICS:"Device.Statistics.WiFi.Radio.",CONFIG_CONNECTIONS:"Device.Network.Connection."};return{pullScan:function(band,$scope){var inx,pathScan,constList=[];return $scope.isSeparateClient?(inx="2.4GHz"==band?$scope.radio.Inx:$scope.radio5G.Inx,pathScan=constants.CONFIG_WIFI_STATISTICS+inx+".SiteSurvey.",constList.push(pathScan)):constList.push(constants.CONFIG_WIFI_SITES),devinfo.once(constList.join("|"),{timeout:6e4}).then(function(data){var data=_.pick(data,_.values(constList));return data})},startUpdateClientStatus:function(cb,$scope){var path=constants.CONFIG_WIFI_STATISTICS+("5GHz"==$scope.band.state?$scope.radio5G.Inx:$scope.radio.Inx)+".EndPoint.",channelPath=constants.CONFIG_WIFI_STATISTICS+("5GHz"==$scope.band.state?$scope.radio5G.Inx:$scope.radio.Inx)+".Channel";devinfo.subscribe(path+"|"+channelPath,function(data){var result,info,channel;data&&(data[path]?(info=_.values(funcs.fetchBranch(data[path],path+".")),channel=funcs.fetchBranch(data[channelPath],channelPath),result={Connect:!_.isEmpty(info[0].Info.BSSID),RSSI:_.isEmpty(info[0].Info.BSSID)?void 0:info[0].Info.SignalStrength+"%",Channel:channel}):result=!1,cb&&cb(result))},$scope)},checkEncryptionType:function(band,standart,encType){switch(encType){case"WEP":case"TKIP":return"2.4GHz"==band?-1==standart.indexOf("n"):"a"==standart;default:return!0}},checkConns:function(iface){if(!iface)return Promise.resolve([]);var result=[];return devinfo.once(constants.CONFIG_CONNECTIONS).then(function(data){var input;return data[constants.CONFIG_CONNECTIONS]?(input=funcs.fetchBranch(data[constants.CONFIG_CONNECTIONS],constants.CONFIG_CONNECTIONS),_.each(funcs.newConfig.normalize(input),function(elem){_.each(funcs.newConfig.normalize(elem),function(obj){(obj.BaseInterface==iface||obj.Interface==iface)&&result.push(obj.Name)})}),result):void 0})["catch"](function(){return Promise.reject()})}}}])}();