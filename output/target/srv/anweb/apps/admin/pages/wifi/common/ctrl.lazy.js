"use strict";!function(){angular.module("app").controllerProvider.register("wifiCommonCtrl",["$scope","$state","translate","history","wifiCommonShared","wifiGeneralUtil","navigationFilter",function($scope,$state,translate,history,shared,util,navigationFilter){function updateChannel(result){result&&($scope.wifi.CurrentChannel="5GHz"==$scope.wifi.band.state?result["5G_Current_channel"]:result.Current_channel)}function wasModified(){return $scope.wifi.isActivate&&device.wifi.isChange()}function changeBand(freq){return(isFormInvalid()||wasModified())===!0?void $state.go($state.current,{freq:freq},{reload:!0}):($scope.wifi.band.state=freq,device.wifi.setBandFreq(freq),$scope.wifi.radio=device.wifi.getBand(0).radio,$scope.wifi.ap.data=device.wifi.getBand(0).ap.get(1),$scope.wifi.advancedAp.bandwidthRestrictedEnable=0!=$scope.wifi.ap.data.BandwidthRestricted,load(freq),$state.go(".",{freq:freq},{notify:!1}),void addChangeToHistory(freq))}function load(freq){var nowHref=location.href.split("#")[1],freqArr=nowHref.split("=");freqArr[1]=freq;var newHref=freqArr.join("=");location.href="#"+newHref}function addChangeToHistory(freq){var last=history.getObj(-1);last.params.freq!==freq&&(history.remove(0,-1),history.add({title:last.title,name:last.name,params:{freq:freq}}))}function isFormInvalid(){return $scope.form.$invalid}var device=$scope.device;device.wifi.helper,$scope.customRules=navigationFilter.rules(),$scope.wifi={isActivate:!1,isSubscribe:!1,radio:null,CurrentChannel:null,ap:{data:null},advancedAp:{bandwidthRestrictedEnable:!1},apply:function(){!isFormInvalid()&&wasModified()&&shared.apply()},applyRegDomain:function(){shared.apply({action:null,freq:null,onlyRegulatoryDomain:!0})},startReselectChan:function(){device.wifi.getBandFreq()},wasModified:wasModified},$scope.wifi.band={list:[],state:null,change:changeBand,translateBand:function(key){return translate("2.4GHz"==key?"24ghz":"5ghz")}},function(){shared.activate().then(function(){$scope.wifi.band.list=[],device.wifi.hasBand("2.4GHz")&&$scope.wifi.band.list.push("2.4GHz"),device.wifi.hasBand("5GHz")&&$scope.wifi.band.list.push("5GHz");var freq=$state.params.freq?$state.params.freq:_.first($scope.wifi.band.list);$scope.wifi.band.state=freq,changeBand(freq),$scope.wifi.isSubscribe||(util.subscribeChannelsInfo(updateChannel,$scope),$scope.wifi.isSubscribe=!0),$scope.wifi.isActivate||($scope.wifi.isActivate=!0,$scope.$emit("pageload"))})}()}])}();