"use strict";!function(){angular.module("app").service("printServerUtil",["cpe","device","devinfo","funcs",function(cpe,device,devinfo,funcs){function getData(){return config?config:{}}var paths={printserver:"Device.Services.PrintServer.",printer:"Device.USB.Printer."},converter=device.printserver.converter,config=null;return{pull:function(){return Promise.all([cpe.GetParameterValues([paths.printserver,paths.printer]),cpe.GetParameterAttributes([paths.printserver])]).then(function(response){var data=funcs.buildTree(response[0].result.ParameterList);return funcs.buildTreeAttributes(response[1].result.ParameterList),config=converter.dsysinitToNative(data),Promise.resolve()},function(){return Promise.reject()})},apply:function(settings){var result={};return funcs.setValue(paths.printserver+"Enable",settings.enable,result),funcs.setValue(paths.printserver+"Printer",settings.printer,result),cpe.ApplyDifference(result)},subscribeInfo:function(cb,$scope){devinfo.subscribe(paths.printserver+"|"+paths.printer,function(response){var printserver,printer,input,data;return response&&response[paths.printserver]&&response[paths.printer]?(printserver=funcs.splitTree(response[paths.printserver]),printer=funcs.splitTree(response[paths.printer]),input=funcs.buildTree(printserver.concat(printer)),data=converter.dsysinitToNative(input),cb&&cb(data)):void 0},$scope)},getData:getData}}])}();