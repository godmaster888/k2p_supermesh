"use strict";angular.module("app").controllerProvider.register("PrintserverCtrl",function($scope,snackbars,funcs,printServerUtil,translate){function init(){function onInfoLoaded(data){_.has(data,"connected")&&($scope.printserver.connected=data.connected),_.has(data,"printerList")&&($scope.printserver.printerList=data.printerList),_.has(data,"printer")&&($scope.printserver.printer=data.printer,__initialData.printer=angular.copy($scope.printserver.printer))}util.pull().then(function(){$scope.printserver=util.getData(),__initialData=angular.copy($scope.printserver),$scope.isActivate=!0,$scope.$emit("pageload")}),util.subscribeInfo(onInfoLoaded,$scope)}var util=printServerUtil,__initialData={};$scope.isActivate=!1,$scope.printserver={},$scope.getStatus=function(){return $scope.printserver.connected?"on":"disconnected"},$scope.checkShowPrintStatus=function(){return $scope.printserver.enable&&!_.isUndefined($scope.printserver.connected)},$scope.checkShowPrinters=function(){return _.has($scope.printserver,"printer")},$scope.checkPrinters=function(){var check=_.find($scope.printserver.printerList,{value:$scope.printserver.printer});check||($scope.printserver.printer="")},$scope.getPrinterList=function(){return[{name:translate("st_not_selected"),value:""}].concat($scope.printserver.printerList)},$scope.apply=function(){var overlay=$scope.overlay.circular,overlayId=overlay.start();util.apply($scope.printserver).then(function(){snackbars.add.bind(snackbars,"msg_rpc_write_success"),init()})["catch"](snackbars.add.bind(snackbars,"msg_rpc_write_error"))["finally"](overlay.stop.bind(overlay,overlayId))},$scope.wasModified=function(){return __initialData.enable!=$scope.printserver.enable||_.has($scope.printserver,"printer")&&__initialData.printer!=$scope.printserver.printer},init()});