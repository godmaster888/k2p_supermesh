"use strict";angular.module("app").controllerProvider.register("MiscCtrl",["$scope","miscUtil","funcs","snackbars","navigationFilter","translate",function($scope,util,funcs,snackbars,filter,translate){function init(){function getPassThroughFuncs(){var result=[];result.push("PPPoE");for(var i in $scope.passThroughs)result.push($scope.passThroughs[i]);return result.join("/")}util.pull().then(function(){$scope.settings=util.getConfig(),__backupNetfilter=angular.copy($scope.settings.netfilter),__backupPassThrough=angular.copy($scope.settings.passThrough),__backupRlxIptvQos=angular.copy($scope.settings.rlxIptvQos),$scope.passThroughFuncs=getPassThroughFuncs(),$scope.$emit("pageload")})["catch"](function(){snackbars.add("msg_rpc_read_error")})["finally"](function(){overlayId&&($scope.overlay.circular.stop(overlayId),overlayId=null)})}var rules=filter.rules();$scope.settings={};var __backupRlxIptvQos=null,__backupNetfilter=null,__backupPassThrough=null,overlayId=null;$scope.passThroughs={pptp:"PPTP",l2tp:"L2TP",ipsec:"IPsec"},init(),$scope.wasModified=function(){return __backupNetfilter&&!_.isEqual(__backupNetfilter,angular.copy($scope.settings.netfilter))||__backupPassThrough&&!_.isEqual(__backupPassThrough,angular.copy($scope.settings.passThrough))||__backupRlxIptvQos&&!_.isEqual(__backupRlxIptvQos,angular.copy($scope.settings.rlxIptvQos))},$scope.supportRlxIptvQos=function(){return!!$scope.settings.rlxIptvQos&&!rules.HideRlxIptvQos},$scope.setIface=function(){},$scope.getLabel=function(label){return translate("miscel_pass_through",{name:label,abr:"name"})},$scope.getDesc=function(proto){return translate("miscel_proto_desc",{name:proto,abr:"name"})},$scope.isDisabledSubmit=function(){return $scope.miscForm.$pristine},$scope.save=function(){function error(){$scope.overlay.circular.stop(overlayId),overlayId=null,snackbars.add("msg_rpc_write_error")}overlayId=$scope.overlay.circular.start(),util.apply($scope.settings).then(function(){snackbars.add("msg_rpc_write_success"),init()})["catch"](error)}}]);