"use strict";angular.module("app").controllerProvider.register("clientsSessionStatsInfoCtrl",["$scope","devinfo","funcs","$timeout","$state","translate","statsSessionsUtil",function($scope,devinfo,funcs,$timeout,$state,translate,util){function mapSessionStats(data){var result=[],clientIp=$state.params.ip,ipv6=!1;return isIpV6(clientIp)&&(clientIp=funcs.ipv6.address.full(clientIp),ipv6=!0),_.each(data,function(item){var source_ip,dest_ip;ipv6?(source_ip=funcs.ipv6.address.full(item.sourceIp),dest_ip=funcs.ipv6.address.full(item.destIp),(clientIp==source_ip||clientIp==dest_ip)&&result.push({sourceIp:funcs.ipv6.address["short"](item.sourceIp),sourcePort:item.sourcePort,destIp:funcs.ipv6.address["short"](item.destIp),destPort:item.destPort,protocol:item.protocol,exp_time:item.exp_time})):(clientIp==item.sourceIp||clientIp==item.destIp)&&result.push(item)}),result}function isIpV6(ip){return ip&&funcs.is.ipv6(ip)}util.subscribeInfo(function(response){$scope.sessionStats=mapSessionStats(response),$scope.$emit("pageload"),$timeout(function(){$scope.loading=!1})},$scope),$scope.getLeaseExpiresTime=function(time){return time?funcs.lookTime(time).toString(function(value){return translate("units_dt_"+value)}):"-"}}]);