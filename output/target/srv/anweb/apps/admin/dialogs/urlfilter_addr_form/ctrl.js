"use strict";function UrlFilterAddrFormDialogCtrl($scope,translate){function wasModified(){return __backupRule&&!_.isEqual(__backupRule,$scope.dialog.rule)}var rule=$scope.ngDialogData.rule,index=$scope.ngDialogData.inx,addrList=$scope.ngDialogData.list;$scope.dialog={header:"",action:null,rule:null,save:function(){if($scope.form.$valid){var changes={rule:$scope.dialog.rule,id:index,action:"save"};$scope.closeThisDialog(changes)}},remove:function(){var changes={rule:$scope.dialog.rule,id:index,action:"remove"};$scope.closeThisDialog(changes)},close:function(){$scope.closeThisDialog(null)},validationUrl:function(rule){var url=rule.url,tmpl=rule.match_mode;return url?function(url){return/^(ht|f)tp(s?)\:/.test(url)}(url)?"urlflt_error_rule_url_contains_protocol":function(url){return url.split("/").length>1}(url)?"urlflt_error_rule_url_contains_subadress":function(url,without){return _.every(addrList,function(elem,index){return without==index?!0:elem.url!=url||elem.match_mode!=tmpl})}(url,index)?null:"urlflt_error_rule_is_not_uniq":null},getTemplatesList:function(){return[{name:"urlflt_dns_tpl_full",value:"full"},{name:"urlflt_dns_tpl_begin",value:"begin"},{name:"urlflt_dns_tpl_end",value:"end"},{name:"urlflt_dns_tpl_middle",value:"middle"}]},isDisabledSave:function(){return"edit"==$scope.dialog.action&&!wasModified()},wasModified:wasModified};var __backupRule=null;!function(){$scope.dialog.header=translate("urlflt_dns_filter"),_.isUndefined(index)?($scope.dialog.action="add",$scope.dialog.rule=$scope.dialog.rule={url:"",match_mode:"full"}):($scope.dialog.action="edit",$scope.dialog.rule=rule,__backupRule=angular.copy($scope.dialog.rule))}()}UrlFilterAddrFormDialogCtrl.$inject=["$scope","translate","device"];