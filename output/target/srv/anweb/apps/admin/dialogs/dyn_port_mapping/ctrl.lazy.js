"use strict";!function(){angular.module("app").controllerProvider.register("dynPortMappingPermissionsCtrl",["$scope","translate","device",function($scope,translate,device){function isNotUniqueRule(){return list&&Object.keys(list).length?_.some(list,function(elem){return _.isEqual(elem,$scope.dialog.rule)}):!1}function wasModified(){return __backupRule&&!_.isEqual(__backupRule,$scope.dialog.rule)}var index=$scope.ngDialogData.inx,data=$scope.ngDialogData.data,list=$scope.ngDialogData.list,funcs=device.funcs,__backupRule=null;$scope.dialog={header:"",action:null,rule:null,attrs:{},save:function(){$scope.form.$valid&&$scope.closeThisDialog({write:$scope.dialog.rule})},remove:function(){$scope.closeThisDialog({remove:{items:[$scope.dialog.rule],index:[index]}})},close:function(){$scope.closeThisDialog(null)},isNotUniqueRule:isNotUniqueRule,checkInternalAddress:function(addr){return _.isEmpty(addr)?null:(-1==addr.indexOf("/")&&(addr+="/0"),funcs.is.ipv4Network(addr)||funcs.is.ipv6Network(addr)?null:"msg_invalid_ip")},isDisabledSave:function(){return isNotUniqueRule()||"edit"==$scope.dialog.action&&!wasModified()}},function(){_.isUndefined(index)?($scope.dialog.action="add",$scope.dialog.header=translate("act_adding_of?name=upnp_rule_oc&abr=name")):($scope.dialog.action="edit",$scope.dialog.header=translate("act_editing_of?name=upnp_rule_oc&abr=name")),$scope.dialog.rule=data,$scope.dialog.attrs.Policy=$scope.ngDialogData.policyList,__backupRule=angular.copy($scope.dialog.rule)}()}])}();