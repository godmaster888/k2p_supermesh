"use strict";function WifiMacEditNetworkDialogCtrl($scope,snackbars,translate){function saveChange(){$scope.networks[band].List[inx]=network,$scope.update($scope.closeThisDialog.bind(null,"saved"))}function saveChangeconfirm(){confirm(translate("wifi_mac_warning_access_loss"))&&saveChange()}var macEnabled,inx=$scope.ngDialogData.inx,band=$scope.ngDialogData.band,network=$scope.network=angular.copy($scope.networks[band].List[inx]),client=($scope.device.wifiMacFilter,$scope.ngDialogData.client),rules=$scope.rules,hasMacInRuls=!1;$scope.header="wifi_mac_network_edit",$scope.save=function(){$scope.wifi_mac_network_form.$valid&&(network.Enable||(network.AccessPolicy="off"),client&&!_.isUndefined(client.mac)?(_.find(_.values(rules),function(key){key.MAC.toUpperCase()==client.mac.toUpperCase()&&(hasMacInRuls=!0,macEnabled=key.Enable)}),network.Enable&&"allow"==network.AccessPolicy&&!hasMacInRuls&&network.SSID==client.SSID?saveChangeconfirm():network.Enable&&"allow"==network.AccessPolicy&&hasMacInRuls&&!macEnabled&&network.SSID==client.SSID?saveChangeconfirm():network.Enable&&"deny"==network.AccessPolicy&&hasMacInRuls&&macEnabled&&network.SSID==client.SSID?saveChangeconfirm():saveChange()):saveChange())},$scope.$watch("network.Enable",function(enabled){enabled&&"off"===network.AccessPolicy&&(network.AccessPolicy="allow")})}