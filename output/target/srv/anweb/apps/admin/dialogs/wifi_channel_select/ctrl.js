"use strict";!function(){angular.module("app").controller("WifiChannelSelectCtrl",["$scope","wifiWorkloadService","translate",function($scope,wifiWorkloadService,translate){var band=$scope.ngDialogData.band;$scope.selectedChannel=!1,$scope.showSpeed="2.4GHz"==band?!1:!0,$scope.selectChannel=function(channel){-1!=_.indexOf($scope.wifiChannelList,parseInt(channel.channel))&&($scope.selectedChannel=channel.channel,channel.neigh_channel&&($scope.neigh=channel.neigh_channel.split(",")))},$scope.apply=function(){-1!=_.indexOf($scope.wifiChannelList,parseInt($scope.selectedChannel))&&$scope.closeThisDialog({selected:!0,channel:$scope.selectedChannel})},$scope.getChannelClass=function(channel){return channel.channel==$scope.selectedChannel?"selected-green":_.contains($scope.neigh,""+channel.channel)?"selected-grey":-1==_.indexOf($scope.wifiChannelList,parseInt(channel.channel))?"disabled-row":void 0},$scope.showInfo=function(channel){return $scope.selectedChannel==channel?!0:!1},$scope.sortChannelsBy=function(param,direction){function sortChannelsWidth(){var element,sorted=_.sortBy($scope.channelsWorkload,function(elem){return elem[param]});for(var i in sorted)for(var j in sorted)sorted[i].width==sorted[j].width&&sorted[i].weight<sorted[j].weight&&(element=sorted[i],sorted[i]=sorted[j],sorted[j]=element);return sorted}$scope.channelsWorkload="width"!=param?_.sortBy($scope.channelsWorkload,function(elem){return elem[param]}):sortChannelsWidth(),"asc"==direction&&$scope.channelsWorkload.reverse()},$scope.translate=function(speed){return"maximum"==speed?translate("wifi_max_speed"):"medium"==speed?translate("wifi_med_speed"):"minimum"==speed?translate("wifi_min_speed"):void 0};var channels=function(src,status){function workload(status){return translate(status)}var output=[];return _.each(_.without(src,"auto"),function(data){output.push({channel:data,workload:workload(status),width:workload(status)})}),output};$scope.loading=!0,function(){$scope.showWorkload=!1,wifiWorkloadService.getInfoChannels(band).then(function(response){$scope.wifiChannelList=response.channels,$scope.channelsWorkload=channels(response.channels,"summary_loading"),$scope.notAllChannels=response.info,$scope.recomend_chan=translate("summary_loading"),wifiWorkloadService.getInfoWorkload(band).then(function(response){response.workload?($scope.channelsWorkload=response.workload.radar_info,$scope.recomend_chan=response.workload.recomend_chan,$scope.showWorkload=!0):$scope.channelsWorkload=channels($scope.wifiChannelList,"wifi_cant_load")},function(){$scope.channelsWorkload=channels($scope.wifiChannelList,"wifi_cant_load")})},function(){$scope.channelsWorkload=[]})["finally"](function(){$scope.loading=!1})}()}])}();