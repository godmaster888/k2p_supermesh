"use strict";!function(){angular.module("app").factory("wifiWorkloadService",["device","funcs","$timeout",function(device,funcs){function getInfoWorkload(band){var output;return workloadData?(output={},output.workload=makeWorkload(workloadData,band),Promise.resolve(output)):device.wifi.getChannels(band).then(function(result){var output={};return output.workload=makeWorkload(result,band),output})}function makeWorkload(input,band){var recomendChannel,result={radar_info:[]},channels=changeChannels(input.channels,band);return _.each(channels.channels,function(channel){result.radar_info.push({channel:channel,weight:input.channelsWorkload[channel].workload,width:input.channelsWorkload[channel].width,neigh_channel:input.channelsWorkload[channel].neigh_channel,speed:input.channelsWorkload[channel].speed}),input.channelsWorkload[channel].recomended&&(recomendChannel=channel)}),result.recomend_chan=recomendChannel,result}function changeChannels(channels,band){var info,radio=device.wifi.getBand(0,band).radio,extChannel=radio.ExtensionChannel,channelBandwidth=radio.OperatingChannelBandwidth;if(extChannel&&~channelBandwidth.indexOf("/"))switch(extChannel){case"BelowControlChannel":channels.splice(0,4),info="wifi_advanced_below_channel";break;case"AboveControlChannel":channels.length=channels.length-4,info="wifi_advanced_above_channel";break;case"Auto":channels=channels}return{channels:channels,info:info}}return{getInfoChannels:function(band){return workloadData=null,device.wifi.getChannels(band).then(function(result){workloadData=funcs.deepClone(result);var output={};return output=changeChannels(result.channels,band)})["catch"](function(){})},getInfoWorkload:getInfoWorkload};var workloadData}])}();