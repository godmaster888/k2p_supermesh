"use strict";angular.module("trouble").controller("errorDonglePinCtrl",["$scope","troubleCheck","somovd","overlay-core","troubleConstants",function($scope,troubleCheck,somovd,overlay,consts){function applyPIN(pinpuk,fn){somovd.write(consts.CONFIG_ID_3G_PIN_NEW,{pin:pinpuk,newpin:"",pinoff:1}).then(function(res){fn(55!=res.status&&65!=res.status?!0:!1)})["catch"](function(){return fn(!1)})}$scope.data=troubleCheck.getData(),$scope.formData={},$scope.getHeaderText=function(status){return"wizard_"+status},$scope.getInputLabel=function(status){return"pin_required"==status?"PIN":"puk_required"==status?"PUK":"puk2_required"==status?"PUK2":void 0},$scope.validationPIN=function(value){if(!value)return null;var re=/^[0-9]{4,8}$/g;return re.test(value)?null:"usb_modem_pin_code_wrong"},$scope.$on("apply",function(){$scope.form.$valid&&$scope.formData.pinpuk&&(overlay.simple.start({action:"apply.pinpuk"}),applyPIN($scope.formData.pinpuk,function(){$scope.onCheckBtnClick(),overlay.simple.stop({action:"apply.pinpuk"})}))})}]);